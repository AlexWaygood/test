language: python

python:
- '2.6'
- '2.7'
- '3.2'
- '3.3'
- '3.4'
- 'pypy'

install:
  - pip install coverage

script: python ./test.py

after_success:
  - pip install pep8 pyflakes
  - pep8 *.py       | tee >(wc -l)
  - pyflakes *.py   | tee >(wc -l)

  # Coverage and quality reports on just the last diff
  - time git fetch origin master:refs/remotes/origin/master
  - time CFLAGS=-O0 pip install --use-wheel diff_cover
  - time coverage xml
  - time diff-cover coverage.xml
  - time diff-quality --violation=pep8
  - time diff-quality --violation=pyflakes
